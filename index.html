<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>OpenAI GPT-Turbo 3.5 Example</title>
  <style>
    .example-prompt {
      margin-right: 10px;
    }

    .example-response {
      margin-right: 10px;
    }

    .remove-example {
      background-color: red;
      color: white;
      border: none;
      border-radius: 5px;
      margin-left: 10px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <h1>OpenAI GPT-Turbo 3.5 Example</h1>
  <p>Enter some example prompts and responses, and a target prompt, and click the "Generate Response" button to see a response generated by the GPT-Turbo 3.5 model:</p>
  <form id="form">
    <div id="examples">
      <div class="example">
        <label class="example-prompt" for="prompt1">Prompt 1:</label>
        <input class="prompt" type="text" name="prompt1" required>
        <label class="example-response" for="response1">Response 1:</label>
        <input class="response" type="text" name="response1" required>
      </div>
    </div>
    <button id="add-example" type="button">Add Example</button>

    <label for="targetPrompt">Target Prompt:</label>
    <input type="text" name="targetPrompt" required><br>

    <button type="submit">Generate Response</button>
  </form>
  <div id="response"></div>

  <script>
    // Add event listener to the "Add Example" button
    const addExampleBtn = document.querySelector("#add-example");
    addExampleBtn.addEventListener("click", addExample);

    // Add event listener to the form submit button
    const form = document.querySelector("#form");
    form.addEventListener("submit", generateResponse);

    /**
     * Add a new example prompt and response field to the form.
     */
    function addExample() {
      const examples = document.querySelector("#examples");
      const exampleCount = examples.children.length;
      const newExample = document.createElement("div");
      newExample.className = "example";
      newExample.innerHTML = `
				<label class="example-prompt" for="prompt${exampleCount + 1}">Prompt ${exampleCount + 1}:</label>
				<input class="prompt" type="text" name="prompt${exampleCount + 1}" required>
				<label class="example-response" for="response${exampleCount + 1}">Response ${exampleCount + 1}:</label>
				<input class="response" type="text" name="response${exampleCount + 1}" required>
				<button class="remove-example" type="button">Remove</button>
			`;
      const removeExampleBtn = newExample.querySelector(".remove-example");
      removeExampleBtn.addEventListener("click", removeExample);
      examples.appendChild(newExample);
    }

    /**
     * Remove the parent example element of the clicked "Remove" button.
     * @param {Event} event - The click event.
     */
    function removeExample(event) {
      const example = event.target.closest(".example");
      example.remove();
    }

    /**
     * Generate a response using the GPT-Turbo 3.5 model.
     * **/

    async function generateResponse(event) {
      event.preventDefault();

      // Gather the inputs
      const prompts = [];
      const responses = [];
      const promptInputs = document.querySelectorAll(".prompt");
      const responseInputs = document.querySelectorAll(".response");
      for (let i = 0; i < promptInputs.length; i++) {
        prompts.push(promptInputs[i].value);
        responses.push(responseInputs[i].value);
      }
      const targetPrompt = document.querySelector("input[name=targetPrompt]").value;

      // Construct the API request data
      const requestData = {
        model: "text-davinci-002",
        prompt: "System: " + responses.join(" ") + " User: " + prompts.join(" ") + " User: " + targetPrompt,
        temperature: 0.5,
        max_tokens: 1024,
        top_p: 1,
        frequency_penalty: 0,
        presence_penalty: 0,
      };

      // Send the API request
      const response = await fetch("https://api.openai.com/v1/engines/gpt-3.5/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer <YOUR_API_KEY_HERE>",
        },
        body: JSON.stringify(requestData),
      });
      const responseData = await response.json();

      // Display the response
      const responseDiv = document.querySelector("#response");
      responseDiv.innerHTML = `<p>${responseData.choices[0].text}</p>`;
    }
  </script>
</body>

</html>